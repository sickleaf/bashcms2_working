#!/bin/bash -eu

source "$(dirname $0)/conf"
exec 2> "$logdir/$(basename $0).$(date +%Y%m%d_%H%M%S).$$"
gitpwd=$(openssl rsautl -decrypt -inkey /home/radipi/passxem/seckey-wd -in /home/radipi/passxem/cipher-wd)

[ -n "${CONTENT_LENGTH}" ] && dd bs=${CONTENT_LENGTH} > /dev/null

echo -e 'Content-type: text/html\n\n'

cd "$contentsdir"
git pull "https://$contents_owner:$gitpwd@github.com/$contents_owner/$contents"
